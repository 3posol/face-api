<!DOCTYPE html>
<html>
<head>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@0.12.0"> </script>
  <script src="../../node_modules/file-saver/FileSaver.js"></script>
</head>
<body>

  <div class="row side-by-side">
    <button
      class="waves-effect waves-light btn"
      onclick="save()"
    >
      Save
    </button>
  </div>

  <script>
    function toDataArray(tensor) {
      return Array.from(tensor.dataSync())
    }

    function flatten(arrs) {
      return arrs.reduce((flat, arr) => flat.concat(arr))
    }

    function initWeights(initializer) {
      const numOutputFilters = 256
      const outputSize = 7

      const weights = toDataArray(initializer.apply([1, 1, numOutputFilters, 7]))
      const bias = toDataArray(tf.zeros([outputSize]))

      return new Float32Array(weights.concat(bias))
    }

    function save() {
      const initialWeights = initWeights(
        tf.initializers.glorotNormal()
      )
      saveAs(new Blob([initialWeights]), `initial_glorot.weights`)
    }

  </script>
</body>
</html>